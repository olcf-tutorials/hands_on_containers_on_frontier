Bootstrap: oras
From: docker.io/subilabrahamornl/opensusempich342rocm571:latest
Stage: devel

%files
./Makefile.frontier_gpu /Makefile.frontier_gpu

%post
zypper install -y bc hwloc-devel
git clone https://github.com/lammps/lammps
cd lammps
git checkout 08498637aa



echo "Changing directory to $(realpath ./lammps/src)..."
cd src

cp /Makefile.frontier_gpu MAKE/MINE

echo "Running clean-all..."
make clean-all

echo "Uninstalling all packages..."
make no-all

echo "Installing selected packages..."
for package in kokkos kspace molecule reaxff rigid; do
    make yes-$package
done

echo "Running 'make -j 8 frontier_gpu'..."
make -j 8 frontier_gpu
build_exit=$?
echo "Build complete. Exit code: ${build_exit}"

Bootstrap: oras
From: docker.io/subilabrahamornl/opensusempich342rocm571:latest
Stage: final

%files from devel
/lammps/src/lmp_frontier_gpu /bin/lmp

%post
zypper install -y bc hwloc-devel


